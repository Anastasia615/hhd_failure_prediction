# HHD Failure Prediction

## Описание проекта

Разработана модель предсказания отказа жестких дисков (HHD) на основе данных мониторинга состояния диска S.M.A.R.T. Цель заключалась в создании решения, способного определить вероятность выхода из строя каждого диска в течение следующих 30 дней. Это позволит принять превентивные меры, уменьшить время простоя и избежать потери данных.

## Как было достигнуто решение

### Сбор и подготовка данных

1. **Сбор данных:**
   - Использован датасет `ST14000NM001G.csv`, содержащий данные S.M.A.R.T. атрибутов и информацию о отказах дисков.
   - Данные загружены с помощью библиотеки Polars, обеспечивая эффективную обработку больших объемов информации.

2. **Предобработка данных:**
   - **Удаление ненужных столбцов:** Исключены строковые столбцы, такие как `date`, `serial_number`, и `model`, чтобы сосредоточиться на числовых признаках.
   - **Преобразование типов:** Преобразован столбец `capacity_bytes` в числовой формат для корректной обработки моделью.
   - **Логарифмическое преобразование:** Применено логарифмирование к SMART-атрибутам для уменьшения влияния выбросов и улучшения распределения данных.
   - **Балансировка классов:** Использован метод SMOTE для увеличения числа примеров класса `failure`, что критично для обучения моделей на несбалансированных данных.

### Инженерия признаков

1. **Создание временных признаков:**
   - Извлечены год, месяц, день недели и день месяца из столбца `date`, что позволило учитывать сезонные и временные тенденции в данных.

2. **Циклические признаки:**
   - Преобразованы временные признаки (месяц, день недели, день месяца) в синусоидальные компоненты (`sin` и `cos`) для сохранения их циклической природы.

3. **Скользящие агрегатные признаки:**
   - Созданы средние и стандартные отклонения для SMART-атрибутов с окном в 7, 14 и 30 дней, что помогло захватить тенденции и сезонные колебания в показателях дисков.

4. **Взаимодействие признаков:**
   - Созданы взаимодействующие признаки между различными SMART-атрибутами и емкостью диска (`capacity_bytes`), что повысило информативность модели.

5. **Кодирование категориальных признаков:**
   - Применен `LabelEncoder` для кодирования категориального признака `model`, преобразовав его в числовой формат.

6. **Создание целевого признака:**
   - Определен целевой признак `failure_future`, представляющий вероятность отказа диска в течение следующих 7 дней, что позволило прогнозировать будущие события.

### Обучение моделей

1. **Выбор моделей:**
   - **LightGBM:** Быстрая и эффективная модель бустинга, идеально подходящая для больших объемов данных.
   - **CatBoost:** Мощная модель градиентного бустинга, хорошо работающая с категориальными признаками и устойчивая к переобучению.

2. **Кросс-валидация:**
   - Использован StratifiedKFold с 5 фолдами для обеспечения стабильности и надежности оценок моделей на различных подвыборках данных.

3. **Балансировка классов:**
   - Применен SMOTE внутри каждого фолда кросс-валидации для увеличения представительства класса `failure`.

4. **Параметризация моделей:**
   - Настроены гиперпараметры LightGBM и CatBoost для оптимизации производительности и устойчивости моделей:
     - Для LightGBM установлено `class_weight='balanced'` для учета несбалансированности данных.
     - Для CatBoost настроены параметры регуляризации и глубины деревьев, чтобы предотвратить переобучение.

5. **Сохранение моделей:**
   - Обученные модели сохранялись с использованием `joblib`, что позволило легко загружать и использовать их в будущем для предсказаний.

### Оценка моделей

1. **Метрики оценки:**
   - **ROC AUC:** Оценка общей способности модели различать классы.
   - **Precision:** Процент правильно предсказанных положительных случаев.
   - **Recall:** Способность модели обнаруживать все реальные положительные случаи.
   - **F1-score:** Гармоническое среднее Precision и Recall.
   - **Confusion Matrix:** Матрица ошибок для детального анализа предсказаний.

2. **Результаты:**
   - **AUC:** 0.96
   - **Precision:** 0.0034
   - **Recall:** 0.6919
   - **F1-score:** 0.0068
   - **Confusion Matrix:**
     ```
     [[7285020   34950]
      [     53     119]]
     ```

## Неудачные эксперименты

1. **Использование моделей без балансировки:**
   - Первоначально пробовали обучать модели без применения SMOTE, но столкнулись с сильно дисбалансированными данными, что привело к высоким показателям AUC, но крайне низкой точности.

2. **Различные методы балансировки:**
   - Пробовали различные методы балансировки, включая RandomUnderSampler, однако SMOTE показал лучшие результаты в увеличении представления класса `failure`.

3. **Попытки с другими моделями:**
   - Тестировались XGBoost и RandomForest, но LightGBM и CatBoost продемонстрировали лучшую производительность и стабильность на данном наборе данных.

4. **Тонкая настройка гиперпараметров:**
   - Проводилась глубокая настройка гиперпараметров, однако обнаружено, что значительная оптимизация не приводит к существенному улучшению метрик, подтверждая, что выбор моделей был оптимальным.

## Описание результатов

### АUC (Area Under Curve) = 0.96

Отличный показатель, свидетельствующий о высокой способности модели различать классы `failure` и `non-failure`. Высокий AUC говорит о том, что модель хорошо ранжирует диски по вероятности отказа.

### Precision (Точность) = 0.0034

Низкий показатель точности означает, что из всех дисков, предсказанных как отказавшие, только 0.34% действительно отказали. Это вызвано сильной дисбалансировкой классов и большим числом ложных положительных предсказаний.

### Recall (Полнота) = 0.6919

Хороший показатель полноты означает, что модель обнаруживает около 69% реальных отказов дисков. Это важно для предотвращения неожиданных сбоев.

### F1-score = 0.0068

Низкий F1-score обусловлен низкой точностью. В условиях сильной дисбалансировки классов F1-score может быть не самым информативным показателем.

### Confusion Matrix
[[7285020 34950]
[ 53 119]]


- **True Negatives (7,285,020):** Правильно предсказанные работающие диски.
- **False Positives (34,950):** Диски, ошибочно предсказанные как отказавшие.
- **False Negatives (53):** Отказавшиеся диски, не обнаруженные моделью.
- **True Positives (119):** Правильно предсказанные отказавшиеся диски.

## Обоснование результатов

### Высокий AUC в сочетании с низкой точностью

Высокий AUC указывает на то, что модель хорошо различает между классами на различных порогах вероятности. Низкая точность обусловлена низким процентом действительно отказавшихся дисков среди предсказанных отказов. В контексте предсказания отказов дисков имеет смысл принимать некоторые ложные срабатывания, поскольку стоимость пропуска реального отказа значительно выше, чем дополнительная проверка дисков, ошибочно помеченных как потенциально отказавшие.

### Приемлемая полнота

За счет приемлемой полноты (69.19%) модель все же обнаруживает значительную часть реальных отказов, что позволяет предпринять меры по замене или ремонту дисков до их выхода из строя.

### Баланс между метриками

В условиях реального применения важно сбалансировать метрики. В данном случае приоритет отдается высокой полноте, несмотря на низкую точность, что оправдано необходимостью минимизировать количество неожиданно отказавшихся дисков.

## Заключение

Проект по предсказанию отказов жестких дисков достиг высоких показателей AUC и приемлемой полноты. Несмотря на низкую точность, в контексте задачи предсказания отказов она является допустимой, так как позволяет своевременно выявлять потенциальные проблемы и предотвращать сбои.

### Рекомендации для дальнейшей работы

1. **Улучшение точности:**
   - Исследовать более сложные методы балансировки классов, такие как ансамблирование резэмплинга.
   - Внедрить новые признаки, возможно, на основе внешних факторов или более детального анализа S.M.A.R.T. атрибутов.

2. **Оптимизация порогов:**
   - Настроить пороги принятия решений для достижения лучшего баланса между точностью и полнотой.
   - Использовать метрики, учитывающие стоимость ошибок, для настройки оптимальных порогов.

3. **Использование ансамблевых методов:**
   - Продолжить работу с ансамблями моделей, возможно, добавить другие алгоритмы для увеличения разнообразия и стабильности предсказаний.

4. **Интерпретация моделей:**
   - Применить методы интерпретации модели, такие как SHAP, для понимания вклада различных признаков в предсказания и дальнейшего улучшения модели.

5. **Автоматизация и мониторинг:**
   - Внедрить процессы автоматического обновления моделей с новыми данными.
   - Создать систему мониторинга для отслеживания производительности модели в реальном времени.
